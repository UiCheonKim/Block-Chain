<!DOCTYPE html>
<html class="no-js" lang="">
  <head>
    <!-- meta charset -->
    <meta charset="utf-8" />
    <!-- site title -->
    <title>예제 및 분석</title>
    <!-- meta description -->
    <meta name="description" content="" />
    <!-- mobile viwport meta -->
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!-- fevicon -->
    <link rel="shortcut icon" type="image/x-icon" />

    <!-- ================================
        CSS Files
        ================================= -->
    <link
      href="https://fonts.googleapis.com/css?family=Libre+Baskerville:400,400i|Open+Sans:400,600,700,800"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-KyZXEAg3QhqLMpG8r+8fhAXLRk2vvoC2f3B09zVXn8CA5QIVfZOJ3BCsw2P0p/We"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="css/themefisher-fonts.min.css" />
    <link rel="stylesheet" href="css/owl.carousel.min.css" />
    <link rel="stylesheet" href="css/main.css" />
    <link rel="stylesheet" href="css/dark.css" />
    <link id="color-changer" rel="stylesheet" href="css/colors/yellow.css" />
  </head>

  <body class="dark">
    <div class="preloader">
      <div class="loading-mask"></div>
      <div class="loading-mask"></div>
      <div class="loading-mask"></div>
      <div class="loading-mask"></div>
      <div class="loading-mask"></div>
    </div>

    <main class="site-wrapper" style="margin: 0.5em 0.5em">
      <!-- .close -->
      <a href="#" onClick="history.back();" class="page-close"
        ><i class="tf-ion-close"></i
      ></a>
      <!-- /.close -->
      <div>
        <div class="page-title">
          <h2>
            Known Attack <span class="primary">예제 및 분석</span>
            <span class="title-bg">Known Attack</span>
          </h2>
        </div>
      </div>

      <div>
        <embed
          src="RE-ENTRANCY(재진입) 공격 - DAO Hacking 사건.pdf"
          type="application/pdf"
          width="100%"
          height="600px"
        />
      </div>

      <!-- <div class="dropdown" style="text-align: center">
        <button
          class="btn btn-danger dropdown-toggle"
          type="button"
          id="dropdownMenuButton1"
          data-bs-toggle="dropdown"
          aria-expanded="false"
        >
          공격 당할 수 있는 코드
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton1">
          <li>
            <a class="dropdown-item" id="one_exam" onclick="one_click()"
              >첫번째 예시</a
            >
          </li>
          <li>
            <a class="dropdown-item" id="two_exam" onclick="two_click()"
              >두번째 예시</a
            >
          </li>
          <li>
            <a class="dropdown-item" id="three_exam" onclick="three_click()"
              >세번째 예시</a
            >
          </li>
        </ul>
      </div>

      <div style="padding-top: 1em">1. Contract</div>

      <div class="half">
        <div class="left">
          <h5>문제점<br /></h5>
          <b>RE-ENTRANCY(재진입) 공격</b>
          <br />
          부재: DAO Hacking 사건
          <br />
          내용:
          <br />
          Re-entrancy 공격으로 인해 몇 백만개의 이더가 16년도에 해킹을 당했다.
          공격자가 이더리움 코인 약 360만달러치를 탈취했다. 당시 가치로는
          7천만달러, 한화 약 9000억원에 달하는 암호화폐가 도난당한 것이다.
          <br />
          결과:
          <br />
          하드포크 방식을 통해 이 해킹사건으로 인해 이더리움 클래식과 이더리움이
          체인을 분리하게 된다.
        </div>
        <div class="middle"><h5>예시</h5></div>
        <div class="right"><h5>코드</h5></div>
      </div>

      <div style="padding-top: 1em">2. Hacker Contract</div>
      <div class="half">
        <div class="left">문제점</div>
        <div class="middle">예시</div>
        <div class="right">코드</div>
      </div>

      <div style="text-align: center">
        <button
          type="button"
          class="btn btn-outline-danger"
          style="margin-top: 2em"
          onclick="solveClick()"
        >
          ↓ 해석 및 코드
        </button>
      </div>

      <div style="padding-top: 1em" class="hidediv">
        1. 수정된 배포 컨트랙트
      </div>

      <div class="half hidediv">
        <div class="left">문제점</div>
        <div class="middle">예시</div>
        <div class="right">코드</div>
      </div>
      <div class="half hidediv">
        <div>설명</div>
      </div> -->
    </main>
    <!-- /.site-wrapper -->

    <!-- ================================
        JavaScript
        ================================= -->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-U1DAWAznBHeqEIlVSCgzq+c9gqGAJn5c/t99JyeKa9xxaYpSvHU5awsuZVVFIhvj"
      crossorigin="anonymous"
    ></script>
    <script src="js/vendor/jquery-2.2.4.min.js"></script>
    <script src="js/vendor/bootstrap.min.js"></script>
    <script src="js/jquery.easing.min.js"></script>
    <script src="js/isotope.pkgd.min.js"></script>
    <script src="js/jquery.nicescroll.min.js"></script>
    <script src="js/owl.carousel.min.js"></script>
    <script src="js/jquery-validation.min.js"></script>
    <script src="js/form.min.js"></script>
    <script src="js/main.js"></script>
    <script type="text/javascript" src="js/ethscan/web3.js"></script>
    <script type="text/javascript" src="js/ethscan/bignumber.min.js"></script>
    <!-- ================================
          ContractScript
        ================================= -->
    <script type="text/javascript">
      if (typeof web3 !== "undefined") {
        web3 = new Web3(web3.currentProvider);
      } else {
        // set the provider you want from Web3.providers
        web3 = new Web3(
          new Web3.providers.HttpProvider("http://localhost:8545")
        );
      }

      console.log(web3.version.api);

      if (web3.isConnected()) console.log("연결완료");
      else console.log("연결실패");

      let accounts = web3.eth.accounts;
      console.log(accounts);

      let startfuc = 0;

      function getclick() {
        var gettxaddr = document.getElementById("gettxaddr").value;
        console.log(gettxaddr);
        //console.log(gettxaddr.indexOf("0x"));
        console.log(Number.isInteger(parseInt(gettxaddr)));
        if (
          gettxaddr.indexOf("0x") == -1 &&
          Number.isInteger(parseInt(gettxaddr))
        )
          getBlock(gettxaddr);
        else if (gettxaddr.length > 50) getTransaction(gettxaddr);
        else getBalance(gettxaddr);
      }

      function getBalance(gettxaddr) {
        console.log("gbal");
        web3.eth.getBalance(gettxaddr, function (error, bal) {
          if (bal == null) return 0;
          console.log(parseInt(bal));
          document.getElementById("txinfo").innerText = parseFloat(
            bal / Math.pow(10, 18)
          );
          document.getElementById("txinfo").style = "border: 2px solid black";
        });
      }

      function getBlock(gettxaddr) {
        console.log("gblock");
        web3.eth.getBlock(parseInt(gettxaddr), function (error, block) {
          if (block == null) return 0;
          //console.log((parseInt(blockNum)));
          document.getElementById("txinfo").innerText = JSON.stringify(block)
            .replace(/\"|\{|\}/g, "")
            .replace(/\,/g, "\n");
          document.getElementById("txinfo").style = "border: 2px solid black";
        });
      }

      function getTransaction(gettxaddr) {
        console.log("tx");
        //var gettxaddr = document.getElementById("gettxaddr").value;
        web3.eth.getTransaction(gettxaddr, function (error, tx) {
          if (tx == null) {
            console.log("gt2");
            return 0;
          }
          console.log("gt3");
          document.getElementById("txinfo").innerText = JSON.stringify(tx)
            .replace(/\"|\{|\}/g, "")
            .replace(/\,/g, "\n");
          document.getElementById("txinfo").style = "border: 2px solid black";
        });
      }
    </script>
    <!-- ================================
          ClickScript
        ================================= -->
    <script>
      function one_click() {
        document.getElementById("dropdownMenuButton1").innerText =
          "첫번째 예시";
      }
      function two_click() {
        document.getElementById("dropdownMenuButton1").innerText =
          "두번째 예시";
      }
      function three_click() {
        document.getElementById("dropdownMenuButton1").innerText =
          "세번째 예시";
      }
      function solveClick() {
        var x = document.getElementsByClassName("hidediv");
        for (var i = 0; i < x.length; i++) {
          if (x[i].style.display == "none") x[i].style.display = "flex";
          else x[i].style.display = "none";
        }
      }
    </script>
  </body>
</html>
<style>
  table {
    border-radius: 0.3em;
    overflow: hidden;
  }
  input {
    height: 25px;
    margin-left: 10%;
    width: 60%;
  }
  thead {
    border-bottom: 4px solid white;
    background-color: #fa6862;
    color: black;
  }
  thead > tr > th {
    padding: 3px;
    text-align: center;
  }
  tbody > tr > td {
    padding: 10px;
    border-bottom: 1px solid white;
  }
  tbody > tr:hover {
    background-color: white;
  }
  .half {
    margin-top: 1em;
    width: 100%;
    height: 300px;
    border: 1px solid white;
    display: flex;
    text-align: left;
  }
  .left {
    overflow-y: scroll;
    width: 30%;
    box-sizing: border-box;
  }
  .middle {
    width: 40%;
    box-sizing: border-box;
  }
  .right {
    width: 30%;
    box-sizing: border-box;
  }
  h5 {
    text-align: center;
  }
  .twohalf {
    width: 50%;
    box-sizing: border-box;
  }
</style>
